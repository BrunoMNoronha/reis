<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reis - Controle Financeiro</title>
    <!-- Adicionada a biblioteca Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <header class="container">
        <div class="logo">Reis</div>
        <button id="theme-toggle-btn" title="Alternar tema">
            <!-- O ícone será inserido via JS -->
        </button>
    </header>

    <main class="container">
        <section class="action-buttons">
            <button class="btn btn-primary" id="add-expense-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg>
                Nova Despesa
            </button>
            <button class="btn btn-secondary" id="add-expense-mic-btn" title="Adicionar despesa por voz">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="22"></line></svg>
                Usar Voz
            </button>
        </section>
        <div id="mic-feedback" class="mic-feedback" style="display: none;"></div>

        <section class="view-toggle">
            <div class="tab active" data-view="list-view">Lista</div>
            <div class="tab" data-view="summary-view">Resumo</div>
        </section>
        
        <!-- Vista da Lista -->
        <section id="list-view" class="view active">
            <div id="expense-list-container">
                <!-- As despesas serão inseridas aqui -->
                <p class="no-expenses-message">Nenhuma despesa registada ainda.</p>
            </div>
        </section>
        
        <!-- Vista do Resumo -->
        <section id="summary-view" class="view">
             <div class="summary-card">
                <div class="summary-header">
                    <div>
                        <h2>Resumo do Mês</h2>
                        <p class="total-expenses" id="summary-total">R$ 0,00</p>
                    </div>
                    <button class="btn btn-primary" id="analyze-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="m12 10-2 2 2 2m-2-2h6"/></svg>
                        Análise Inteligente
                    </button>
                </div>
                <!-- Novo: Container para o gráfico -->
                <div class="chart-container">
                    <canvas id="expense-chart"></canvas>
                </div>
                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 1rem 0;">
                <div id="summary-by-category">
                    <!-- O resumo por categoria será inserido aqui -->
                </div>
            </div>
            <div id="analysis-container" class="analysis-card" style="display: none;">
                <h3>✨ Análise Inteligente de Despesas</h3>
                <div id="analysis-content" class="content"></div>
            </div>
        </section>
        
    </main>

    <footer class="container">
        <p>&copy; 2024 Reis. Simples, direto e local.</p>
    </footer>

    <!-- Template para itens da lista de despesas -->
    <template id="expense-item-template">
        <article class="expense-list-item">
            <div class="expense-info">
                <div class="value"></div>
                <div class="category"></div>
                <div class="date"></div>
                <div class="observation"></div>
            </div>
            <div class="expense-actions">
                <button class="delete-btn" title="Excluir despesa">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                </button>
            </div>
        </article>
    </template>
    
    <!-- Modal para adicionar despesa -->
    <div id="expense-modal" class="modal">
        <div class="modal-content">
            <h2 id="modal-title">Nova Despesa</h2>
            <form id="expense-form">
                <input type="hidden" id="expense-id">
                <div class="form-group">
                    <label for="value">Valor (R$)</label>
                    <input type="number" id="value" step="0.01" placeholder="25,00" required>
                </div>
                <div class="form-group">
                    <label for="category">Categoria</label>
                    <select id="category" required>
                        <option value="">Selecione uma categoria</option>
                        <option>Alimentação</option>
                        <option>Transporte</option>
                        <option>Moradia</option>
                        <option>Lazer</option>
                        <option>Saúde</option>
                        <option>Educação</option>
                        <option>Compras</option>
                        <option>Outros</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="date">Data</label>
                    <input type="date" id="date" required>
                </div>
                <div class="form-group">
                    <label for="observation">Observação (Opcional)</label>
                    <input type="text" id="observation" placeholder="Ex: Almoço com cliente">
                </div>
                <div class="form-buttons">
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                    <button type="button" class="btn btn-secondary" id="cancel-btn">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Novo: Modal de Confirmação -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <h2 id="confirm-title">Confirmar Exclusão</h2>
            <p id="confirm-message" style="margin: 1.5rem 0;">Tem a certeza de que deseja excluir esta despesa? Esta ação não pode ser desfeita.</p>
            <div class="form-buttons">
                <button id="confirm-ok-btn" class="btn btn-danger">Excluir</button>
                <button id="confirm-cancel-btn" class="btn btn-secondary">Cancelar</button>
            </div>
        </div>
    </div>


    <script src="js/app.js"></script>
</body>
</html>
